[{"content":"A.程式說明 在用爬蟲爬取網站資料時，通常都會遇到表格或資料需要點選第2頁、第3頁、等等的按鈕來切換爬取。此時可以透過觀察網址的變化，一頁一頁爬取到需要的資料為止。\n以巴哈姆特手機遊戲排行榜為範例： 一般情況下直接點進手機遊戲排行榜會看到的是縮圖模式，在此模式下要看到更後面的排行僅能透過滑鼠滾輪往下滑，並會發現網頁是瀑布式載入，當前頁面可以載入到第100名甚至更後面名次的遊戲，但若直接對當前頁面的網址進行爬蟲，爬取當前網址所能獲取的資料也僅有前30筆，因此在此情況下無法觀察到網頁的變化。\n較理想觀察變化方式是點進清單模式，此模式下有頁面選擇按鈕可以點選。可以觀察到以下網址在不同頁面時只有page的部分有變化，因此就可以透過迴圈或指定的方式爬取所需要的資料。\n第一頁：https://forum.gamer.com.tw/index.php?page=1\u0026amp;c=94\n第二頁：https://forum.gamer.com.tw/index.php?page=2\u0026amp;c=94\n爬取其他排行榜： 透過觀察以下網址也可以發現不同分類的遊戲網址變化\n手機： https://forum.gamer.com.tw/index.php?page=1\u0026c=94\nPC： https://forum.gamer.com.tw/index.php?page=1\u0026c=500\nTV掌機： https://forum.gamer.com.tw/index.php?page=1\u0026c=52\nB.使用及安裝套件(環境：Windows系統) 打開Windows系統內建終端機(cmd)，並安裝以下模組，若曾安裝過以下套件可跳過此步驟。\n安裝requests模組\npip install requests 安裝BeautifulSoup模組\npip install beautifulsoup4 安裝pandas模組\npip install pandas C.程式碼分享 import requests from bs4 import BeautifulSoup import pandas as pd import datetime headers = { \u0026quot;User-Agent\u0026quot;: \u0026quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.54 Safari/537.36\u0026quot; } mobile = \u0026quot;https://forum.gamer.com.tw/ajax/rank.php?c=94\u0026amp;page=\u0026quot; pc = \u0026quot;https://forum.gamer.com.tw/ajax/rank.php?c=500\u0026amp;page=\u0026quot; tv = \u0026quot;https://forum.gamer.com.tw/ajax/rank.php?c=52\u0026amp;page=\u0026quot; r_list = [mobile, pc, tv] r_name = ['mobile', 'pc', 'tv'] def get_ranking_info_list(url): \u0026quot;\u0026quot;\u0026quot;取得排名列表\u0026quot;\u0026quot;\u0026quot; rankings = [] for page in range(1, 5): website = url + str(page) r = requests.get(website, headers=headers) rankings_duct = r.json() for value in rankings_duct: rankings.append( { '板塊名稱': value.get('title'), '板塊id': value.get('bsn'), '熱度': value.get('hot'), '文章數量': value.get('article'), '排名': value.get('ranking'), '日期': datetime.date.today(), } ) return rankings num = 0 for item in r_list: df = pd.DataFrame(get_ranking_info_list(item)) df['類別'] = r_name[num] df.to_csv(r_name[num] ,index=False, mode='a') num += 1 ","date":"2022-09-05T00:00:00+02:00","permalink":"https://pikao777.github.io/posts/test-post/","title":"Python爬蟲-巴哈姆特遊戲排行榜(Draft)"}]